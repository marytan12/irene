<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Irene - 1er Aniversario</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400;1,600&display=swap"
        rel="stylesheet">
    <style>
        /* --- CONFIGURACIÓN BASE & TIPOGRAFÍA --- */
        :root {
            --paper-color: #fdfbf7;
            --ink-color: #4a4a4a;
            --accent-color: #be123c;
        }

        body {
            font-family: 'Playfair Display', serif;
            background-color: var(--paper-color);
            color: var(--ink-color);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .font-script {
            font-family: 'Dancing Script', cursive;
        }

        /* Textura de papel granulado (Noise) */
        .bg-noise {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.04;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* --- ESTILOS DEL SOBRE (MEJORADO) --- */
        #envelope-layer {
            transition: opacity 0.8s ease 0.5s; /* Delay fade out slightly */
            z-index: 100;
            background-color: #fdfbf7;
            perspective: 1500px; /* Para efecto 3D en la solapa */
        }

        .envelope-wrapper {
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1s cubic-bezier(0.6, 0.05, 0.2, 0.9);
        }

        /* Cuerpo del sobre */
        .envelope-body {
            background: linear-gradient(145deg, #eecaca 0%, #f3dcdc 100%);
            box-shadow: 
                inset 0 -10px 30px rgba(0,0,0,0.05),
                0 30px 60px -10px rgba(190, 18, 60, 0.2);
            position: relative;
            z-index: 20;
        }

        /* Solapa triangular */
        .envelope-flap {
            clip-path: polygon(0 0, 50% 100%, 100% 0);
            background: linear-gradient(180deg, #e5b8b8 0%, #dca3a3 100%);
            transform-origin: top;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1), z-index 0s linear 0.4s;
            z-index: 30;
            /* Sombra sutil debajo de la solapa */
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
        }

        .envelope-flap.open {
            transform: rotateX(180deg);
            z-index: 10; /* Se va detrás al abrirse */
            filter: brightness(0.9); /* Un poco más oscuro al estar "atrás" */
        }

        /* Sello de lacre mejorado */
        .heart-seal {
            background: radial-gradient(circle at 30% 30%, #be123c, #881337);
            box-shadow: 
                inset 2px 2px 4px rgba(255,255,255,0.3),
                inset -2px -2px 4px rgba(0,0,0,0.2),
                0 4px 10px rgba(0,0,0,0.3);
            border: 2px solid #9f1239;
            cursor: pointer;
            z-index: 40;
            /* Forma irregular sutil */
            border-radius: 50% 45% 55% 48% / 48% 52% 45% 55%; 
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.4s ease;
        }

        .heart-seal:hover {
            transform: scale(1.1);
        }

        .heart-seal.broken {
            transform: scale(1.3);
            opacity: 0;
            pointer-events: none;
        }

        /* --- ANIMACIONES GENERALES --- */
        .fade-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 1s ease-out, transform 1s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .fade-in-up.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .delay-100 { transition-delay: 0.1s; }
        .delay-300 { transition-delay: 0.3s; }
        .delay-500 { transition-delay: 0.5s; }

        /* --- CARRUSEL POLAROID --- */
        .carousel-container {
            perspective: 1000px;
        }

        .polaroid-frame {
            background: #fff;
            padding: 15px 15px 60px 15px;
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
            transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1), opacity 0.4s ease;
            transform-origin: center top;
            position: relative;
        }

        .polaroid-frame.swapping {
            transform: rotate(5deg) translateX(50px);
            opacity: 0;
        }

        .polaroid-frame.swapping-in {
            transform: rotate(-5deg) translateX(-50px);
            opacity: 0;
        }

        .photo-container {
            background-color: #f0f0f0;
            overflow: hidden;
            aspect-ratio: 4/5;
        }

        .photo-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: contrast(1.05) brightness(1.02);
        }

        .nav-btn {
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            transform: scale(1.1);
            background-color: rgba(190, 18, 60, 0.1);
        }

        .nav-btn:active {
            transform: scale(0.95);
        }

        .tape {
            background-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(2px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>

<body class="min-h-screen relative selection:bg-rose-200 selection:text-rose-900">

    <div class="bg-noise"></div>

    <!-- --- CAPA 1: EL SOBRE (INTRODUCCIÓN) --- -->
    <div id="envelope-layer"
        class="fixed inset-0 w-full h-full flex items-end justify-center z-50 overflow-hidden">
        
        <div class="absolute top-1/4 w-full text-center opacity-60 px-6 transition-opacity duration-500" id="intro-text">
            <p class="font-script text-3xl text-rose-800 animate-bounce">Desliza o haz clic para abrir</p>
        </div>

        <div class="relative w-full max-w-lg h-[85vh] flex flex-col items-center justify-end envelope-wrapper" id="envelope-wrapper">
            <div class="envelope-body w-full h-full rounded-t-[3rem] relative flex items-center justify-center">
                
                <!-- Solapa del sobre -->
                <div id="envelope-flap" class="absolute top-0 w-full h-64 envelope-flap shadow-lg rounded-b-[50%]"></div>
                
                <!-- Sello de Lacre -->
                <div id="seal-btn"
                    class="absolute top-48 bg-rose-700 text-white rounded-full w-24 h-24 flex items-center justify-center heart-seal touch-none select-none">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24"
                        fill="currentColor" class="opacity-90 drop-shadow-sm">
                        <path
                            d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                    </svg>
                </div>

                <div class="absolute bottom-32 w-full text-center px-4 z-10">
                    <h1 class="text-rose-900/30 text-7xl font-script select-none">Para Irene</h1>
                </div>
            </div>
        </div>
    </div>

    <!-- --- CAPA 2: CONTENIDO PRINCIPAL --- -->
    <main id="main-content"
        class="relative w-full max-w-2xl mx-auto px-6 py-20 hidden opacity-0 transition-opacity duration-1000">

        <!-- HEADER -->
        <header class="text-center mb-16 fade-in-up delay-100">
            <div class="inline-block mb-4">
                <img src="logo.png" alt="Logo"
                    class="w-16 h-16 object-contain animate-[pulse_4s_ease-in-out_infinite] opacity-90 mx-auto"
                    onerror="this.style.display='none'">
            </div>
            <h1 class="font-script text-7xl md:text-8xl text-rose-800 mb-4 leading-tight">Feliz<br>Aniversario</h1>
            <div class="flex items-center justify-center gap-4 text-gray-400 font-serif italic text-lg mt-6">
                <span class="h-[1px] w-12 bg-rose-200"></span>
                <span>28 de Noviembre</span>
                <span class="h-[1px] w-12 bg-rose-200"></span>
            </div>
        </header>

        <!-- CARTA -->
        <section class="mb-24 fade-in-up delay-300 relative">
            <div class="bg-white p-10 md:p-14 shadow-xl rounded-sm relative transform rotate-1 border border-gray-50">
                <div class="tape absolute -top-3 left-1/2 -translate-x-1/2 w-32 h-8 rotate-[-2deg]"></div>
                <div class="prose prose-lg prose-rose mx-auto font-serif text-gray-600 leading-loose">
                    <p class="first-letter:text-5xl first-letter:font-script first-letter:text-rose-600 first-letter:float-left first-letter:mr-3">
                        Holi amorcito,
                    </p>
                    <p>
                        ¿Qué tal? Bueno, ya sabes que te amo mucho, demasiado, que eres muy importante para mí, y que cada día me enamoras más. Me alegro muchísimo de que llevemos un año, y espero que sea el primero de 30000 más. Me encantaría estar toda mi vida contigo y dedicártela a ti, la vida también. Eres la única persona que me ha querido tanto y que yo he sentido que me quiere, y que yo quiero tanto.
                    </p>
                    <p>
                        Me alegra mucho el tener a alguien que haga lo que haga y aunque a veces lo haga mal siempre esté orgullosa de mí, siempre me das ganas de continuar cuando todo lo demás se pone en mi contra. Sé que dentro de este año ha habido momentos muy difíciles, pero lo importante es que hemos sabido superarlo como nadie lo ha hecho nunca y que seguimos aquí. De hecho, después de discutir yo te quiero más porque me doy cuenta de lo que me queda si te pierdo, y me doy cuenta.
                    </p>
                    <p>
                        Que por cierto, lo que me queda si te vas es literalmente nada, una cosa vacía, y después de que llegases tú me he dado cuenta lo importante que eres. En esta carta no me quiero fijar en el futuro, creo que es mejor demostrar a nuestros yos del futuro que fuimos capaces de pasar por todo juntos. Pero ahora mismo de lo que más me alegro es de que estés leyendo esto porque significa que estás aquí.
                    </p>
                    <p>
                         Espero que te gusten las flores que te voy a dar (ahora es el momento en el que me miras y dices ¿Qué flores? Y voy yo a por ellas).
                    </p>
                    <p>
                        Bueno, tampoco tengo mucho más que decir que no haya hecho ya. Que sepas que te quiero mucho. Que vales mucho. Y que eres muy importante para mí. Gracias por este año.
                    </p>
                </div>
            </div>
        </section>

        <!-- CARRUSEL DE FOTOS -->
        <section class="pb-20 fade-in-up delay-500">
            <div class="text-center mb-8">
                <h2 class="font-script text-4xl text-rose-800">Nuestros Momentos</h2>
            </div>

            <div class="carousel-container relative max-w-sm mx-auto">

                <!-- Marco Polaroid Dinámico -->
                <div id="polaroid-frame" class="polaroid-frame transform rotate-[-2deg]">
                    <!-- Cinta decorativa -->
                    <div class="tape absolute -top-4 left-1/2 -translate-x-1/2 w-24 h-6 rotate-2 z-10"></div>

                    <!-- Contenedor de Imagen -->
                    <div class="photo-container mb-4">
                        <img id="carousel-img" src="https://images.unsplash.com/photo-1518568814500-bf0f8d125f46?q=80&w=1000&auto=format&fit=crop" alt="Recuerdo" class="transition-opacity duration-300">
                    </div>

                    <!-- Pie de foto (Contador) -->
                    <div class="flex justify-between items-end px-2">
                        <div class="font-script text-2xl text-gray-600" id="photo-caption">Recuerdo especial</div>
                        <div class="font-serif text-xs text-gray-400 tracking-widest" id="photo-counter">1 / 14</div>
                    </div>
                </div>

                <!-- Controles de Navegación -->
                <div class="flex justify-between items-center mt-10 px-4">
                    <button onclick="prevSlide()"
                        class="nav-btn p-3 rounded-full text-rose-600 hover:text-rose-800 focus:outline-none"
                        aria-label="Anterior">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m15 18-6-6 6-6" />
                        </svg>
                    </button>

                    <button onclick="nextSlide()"
                        class="nav-btn p-3 rounded-full text-rose-600 hover:text-rose-800 focus:outline-none"
                        aria-label="Siguiente">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m9 18 6-6-6-6" />
                        </svg>
                    </button>
                </div>

            </div>
        </section>

        <!-- FOOTER -->
        <footer class="text-center py-20 fade-in-up delay-500">
            <p class="font-serif italic text-gray-400 mb-4">Por muchos años más construyendo recuerdos</p>
            <div class="text-rose-300 text-2xl">∞</div>
        </footer>

    </main>

    <script>
        // --- LÓGICA DEL CARRUSEL ---
        const photos = [
            '1.jpeg', '2.jpeg', '3.jpg', '4.jpg', '5.jpg',
            '6.jpg', '7.jpg', '8.jpg', '9.jpg', '10.jpg',
            '11.jpg', '12.jpg', '13.jpg', '14.jpg'
        ];

        const captions = [
            "El Comienzo", "BeReal", "Foto Goty", "Hallowen, tenia ganas de potar", "Los dos",
            "Vaya cara de mrd", "Ayuda", "que cuquis", "que cuquis otra vez", "Que monisss",
            "Brutal", "Goty, falta guiille xd", "Durisimo", "Casi tan perfecto como tu"
        ];

        let currentIndex = 0;
        const imgElement = document.getElementById('carousel-img');
        const counterElement = document.getElementById('photo-counter');
        const captionElement = document.getElementById('photo-caption');
        const frameElement = document.getElementById('polaroid-frame');

        imgElement.onerror = function() {
            this.src = 'https://images.unsplash.com/photo-1529619768328-e37af76c6fe5?auto=format&fit=crop&w=600&q=80';
            this.onerror = null;
        };

        updateCarousel(false);

        function updateCarousel(animate = true) {
            if (animate) {
                frameElement.classList.add('swapping');
                setTimeout(() => {
                    setSrcAndText();
                    frameElement.classList.remove('swapping');
                    frameElement.classList.add('swapping-in');
                    requestAnimationFrame(() => {
                        requestAnimationFrame(() => {
                            frameElement.classList.remove('swapping-in');
                        });
                    });
                }, 300);
            } else {
                setSrcAndText();
            }
        }

        function setSrcAndText() {
            imgElement.src = photos[currentIndex];
            counterElement.textContent = `${currentIndex + 1} / ${photos.length}`;
            captionElement.textContent = captions[currentIndex % captions.length];
            const randomRotate = (Math.random() * 4 - 2).toFixed(1);
            frameElement.style.transform = `rotate(${randomRotate}deg)`;
        }

        function nextSlide() {
            currentIndex = (currentIndex + 1) % photos.length;
            updateCarousel(true);
        }

        function prevSlide() {
            currentIndex = (currentIndex - 1 + photos.length) % photos.length;
            updateCarousel(true);
        }

        // --- LÓGICA DEL SOBRE (MEJORADA) ---
        const sealBtn = document.getElementById('seal-btn');
        const envelopeLayer = document.getElementById('envelope-layer');
        const mainContent = document.getElementById('main-content');
        const flap = document.getElementById('envelope-flap');
        const introText = document.getElementById('intro-text');
        const envelopeWrapper = document.getElementById('envelope-wrapper');

        let startY = 0;
        let currentY = 0;
        let isDragging = false;
        let isOpening = false;

        function openEnvelope() {
            if(isOpening) return;
            isOpening = true;

            // 1. Ocultar texto de intro
            introText.style.opacity = '0';

            // 2. Animación del sello (romperse)
            sealBtn.classList.add('broken');

            // 3. Animación de la solapa (abrirse) después de un instante
            setTimeout(() => {
                flap.classList.add('open');
            }, 200);

            // 4. Mover el sobre hacia abajo para "salir" de la pantalla y revelar contenido
            setTimeout(() => {
                envelopeWrapper.style.transform = 'translateY(100vh)';
                envelopeLayer.style.opacity = '0';
            }, 800);

            // 5. Mostrar contenido real
            setTimeout(() => {
                envelopeLayer.style.display = 'none';
                mainContent.classList.remove('hidden');
                
                // Activar animaciones del contenido
                setTimeout(() => {
                    mainContent.style.opacity = '1';
                    document.querySelectorAll('.fade-in-up').forEach((el) => {
                        el.classList.add('visible');
                    });
                }, 100);
            }, 1600); // Tiempo total calculado para que sea fluido
        }

        // --- Manejadores de Eventos ---

        // Opción: Click directo en el sello
        sealBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // Evitar conflictos
            openEnvelope();
        });

        // Opción: Drag (Touch)
        sealBtn.addEventListener('touchstart', (e) => {
            if(isOpening) return;
            isDragging = true;
            startY = e.touches[0].clientY;
            sealBtn.style.transition = 'none';
        }, { passive: false });

        document.addEventListener('touchmove', (e) => {
            if (!isDragging || isOpening) return;
            e.preventDefault();
            currentY = e.touches[0].clientY;
            let deltaY = currentY - startY;

            // Solo permitir arrastrar hacia arriba ligeramente
            if (deltaY < 0 && deltaY > -200) {
                sealBtn.style.transform = `translateY(${deltaY}px)`;
            }
        }, { passive: false });

        document.addEventListener('touchend', (e) => {
            if (!isDragging) return;
            isDragging = false;
            let deltaY = currentY - startY;

            // Umbral para abrir
            if (deltaY < -100) { // Si se arrastró más de 100px hacia arriba
                openEnvelope();
            } else {
                // Volver a posición original si no se abrió
                sealBtn.style.transition = 'transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                sealBtn.style.transform = 'translateY(0)';
            }
        });

        // Opción: Drag (Mouse)
        sealBtn.addEventListener('mousedown', (e) => {
            if(isOpening) return;
            isDragging = true;
            startY = e.clientY;
            sealBtn.style.transition = 'none';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging || isOpening) return;
            currentY = e.clientY;
            let deltaY = currentY - startY;

            if (deltaY < 0 && deltaY > -200) {
                sealBtn.style.transform = `translateY(${deltaY}px)`;
            }
        });

        document.addEventListener('mouseup', (e) => {
            if (!isDragging) return;
            isDragging = false;
            let deltaY = currentY - startY;

            if (deltaY < -100) {
                openEnvelope();
            } else {
                sealBtn.style.transition = 'transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                sealBtn.style.transform = 'translateY(0)';
            }
        });

        // Observer para animaciones de scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.fade-in-up').forEach(el => observer.observe(el));
    </script>
</body>

</html>
